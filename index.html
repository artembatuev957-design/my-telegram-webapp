<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #1a1a1a; --txt: #fff; --accent: #007aff; --card: #2b2b2b; }
        body.light { --bg: #f0f0f2; --txt: #000; --card: #fff; }
        body { background: var(--bg); color: var(--txt); font-family: -apple-system, sans-serif; margin: 0; padding: 20px; transition: 0.3s; overflow-x: hidden; }
        .screen { display: none; min-height: 100vh; }
        .active { display: block; }

        /* –í–∏–¥–∂–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞ –≤ —É–≥–ª—É */
        #mini-avatar { position: fixed; top: 15px; right: 15px; width: 45px; height: 45px; border-radius: 50%; border: 2px solid #fff; display: flex; align-items: center; justify-content: center; z-index: 1000; font-size: 24px; }

        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 50px; }
        .app { display: flex; flex-direction: column; align-items: center; cursor: pointer; font-size: 12px; }
        .icon { width: 65px; height: 65px; border-radius: 18px; display: flex; align-items: center; justify-content: center; font-size: 30px; margin-bottom: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.4); }

        /* –ò–≥—Ä—ã */
        .games-bg { background: linear-gradient(45deg, #ff00cc, #333399); position: fixed; inset: 0; padding: 20px; overflow-y: auto; z-index: 50; }
        .game-card { background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); padding: 18px; border-radius: 15px; margin-bottom: 15px; display: flex; align-items: center; gap: 15px; border: 1px solid rgba(255,255,255,0.2); font-weight: bold; color: #fff; }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .section { background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 15px; }
        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        button { border: none; padding: 10px 15px; border-radius: 8px; background: var(--accent); color: #white; cursor: pointer; font-weight: 500; }
        .bg-opt { width: 50px; height: 50px; border-radius: 10px; cursor: pointer; border: 2px solid #fff; }

        /* –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∞ */
        .preview-big { width: 120px; height: 120px; border-radius: 50%; margin: 20px auto; display: flex; align-items: center; justify-content: center; font-size: 60px; border: 4px solid var(--accent); transition: 0.2s; }
        .scroll { display: flex; overflow-x: auto; gap: 15px; padding: 10px 0; scrollbar-width: none; }
        .item { flex: 0 0 60px; height: 60px; border-radius: 12px; background: #444; display: flex; align-items: center; justify-content: center; font-size: 30px; }

        .back { color: var(--accent); cursor: pointer; font-weight: bold; margin-bottom: 20px; display: inline-block; }
    </style>
</head>
<body>

    <div id="mini-avatar" style="background: #84fab0;">üë®</div>

    <div id="main" class="screen active">
        <div class="grid">
            <div class="app" onclick="send('/weather')">
                <div class="icon" style="background: linear-gradient(135deg, #ff9a9e, #fecfef);">‚òÄÔ∏è</div>
                <span>–ü–æ–≥–æ–¥–∞</span>
            </div>
            <div class="app" onclick="openScr('games')">
                <div class="icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">üéÆ</div>
                <span>–ò–≥—Ä—ã</span>
            </div>
            <div class="app" onclick="openScr('settings')">
                <div class="icon" style="background: linear-gradient(135deg, #bdc3c7, #2c3e50);">‚öôÔ∏è</div>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </div>
            <div class="app" onclick="openScr('avatar')">
                <div class="icon" style="background: linear-gradient(135deg, #84fab0, #8fd3f4);">üë§</div>
                <span>–ê–≤–∞—Ç–∞—Ä</span>
            </div>
        </div>
    </div>

    <div id="games" class="screen">
        <div class="games-bg">
            <span class="back" style="color:#fff" onclick="openScr('main')">‚Üê –ù–∞–∑–∞–¥</span>
            <h2 style="color:#fff">–ò–≥—Ä–æ–≤–æ–π –¶–µ–Ω—Ç—Ä</h2>
            <div class="game-card" onclick="play('–ó–º–µ–π–∫–∞')">üêç –ó–º–µ–π–∫–∞</div>
            <div class="game-card" onclick="play('–õ–∞–±–∏—Ä–∏–Ω—Ç')">üß± –õ–∞–±–∏—Ä–∏–Ω—Ç</div>
            <div class="game-card" onclick="play('–°–∞–ø—ë—Ä')">üí£ –°–∞–ø—ë—Ä</div>
            <div class="game-card" onclick="play('–¢–∞–Ω—á–∏–∫–∏')">üöú –¢–∞–Ω—á–∏–∫–∏</div>
        </div>
    </div>

    <div id="settings" class="screen">
        <span class="back" onclick="openScr('main')">‚Üê –ù–∞–∑–∞–¥</span>
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="section">
            <h3>–Ø–∑—ã–∫</h3>
            <div class="btn-row">
                <button onclick="setL('üá∑üá∫ RU')">üá∑üá∫ RU</button>
                <button onclick="setL('üá∫üá∏ EN')">üá∫üá∏ EN</button>
                <button onclick="setL('üáßüáæ BY')">üáßüáæ BY</button>
                <button onclick="setL('üá∞üáø KZ')">üá∞üáø KZ</button>
                <button onclick="setL('üá®üá≥ CN')">üá®üá≥ CN</button>
            </div>
        </div>
        <div class="section">
            <h3>–¢–µ–º–∞</h3>
            <div class="btn-row">
                <button onclick="document.body.classList.add('light')">–°–≤–µ—Ç–ª–∞—è</button>
                <button onclick="document.body.classList.remove('light')">–¢–µ–º–Ω–∞—è</button>
            </div>
        </div>
        <div class="section">
            <h3>–§–æ–Ω —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="btn-row">
                <div class="bg-opt" style="background: linear-gradient(to bottom, #1e3c72, #2a5298)" onclick="setB(this)"></div>
                <div class="bg-opt" style="background: linear-gradient(to bottom, #ee9ca7, #ffdde1)" onclick="setB(this)"></div>
                <div class="bg-opt" style="background: linear-gradient(to bottom, #11998e, #38ef7d)" onclick="setB(this)"></div>
            </div>
        </div>
    </div>

    <div id="avatar" class="screen">
        <span class="back" onclick="openScr('main')">‚Üê –ù–∞–∑–∞–¥</span>
        <div id="p-big" class="preview-big" style="background:#84fab0">üë®</div>
        <h3>–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>
        <div class="scroll">
            <div class="item" onclick="setA('üë®')">üë®</div>
            <div class="item" onclick="setA('üë©')">üë©</div>
            <div class="item" onclick="setA('üßî')">üßî</div>
            <div class="item" onclick="setA('üë±‚Äç‚ôÄÔ∏è')">üë±‚Äç‚ôÄÔ∏è</div>
            <div class="item" onclick="setA('üëµ')">üëµ</div>
            <div class="item" onclick="setA('üë¥')">üë¥</div>
        </div>
        <h3>–¶–≤–µ—Ç —Ñ–æ–Ω–∞</h3>
        <div class="scroll">
            <div class="bg-opt" style="background:#ff5f6d" onclick="setAB('#ff5f6d')"></div>
            <div class="bg-opt" style="background:#84fab0" onclick="setAB('#84fab0')"></div>
            <div class="bg-opt" style="background:#a1c4fd" onclick="setAB('#a1c4fd')"></div>
            <div class="bg-opt" style="background:#fbc2eb" onclick="setAB('#fbc2eb')"></div>
        </div>
        <button style="width:100%; margin-top:30px; padding:15px" onclick="saveA()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        let curE = 'üë®', curC = '#84fab0';

        function openScr(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            tg.HapticFeedback.impactOccurred('medium');
        }

        function setL(l) { tg.showPopup({title: '–Ø–∑—ã–∫', message: '–í—ã–±—Ä–∞–Ω: ' + l}); }
        function setB(el) { document.body.style.background = el.style.background; }
        function setA(e) { curE = e; updateP(); }
        function setAB(c) { curC = c; updateP(); }
        
        function updateP() {
            const b = document.getElementById('p-big');
            const m = document.getElementById('mini-avatar');
            b.innerText = m.innerText = curE;
            b.style.background = m.style.background = curC;
        }

        function play(n) {
            let s = Math.floor(Math.random() * 99999);
            tg.sendData("GAME:" + n + ":" + s);
            tg.close();
        }

        function send(d) { tg.sendData(d); tg.close(); }
        function saveA() { tg.sendData("AVATAR:" + curE + ":" + curC); tg.close(); }
    </script>
</body>
</html>
