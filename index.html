<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #1a1a1a; --txt: #fff; --accent: #007aff; --card: #2b2b2b; }
        body.light { --bg: #f0f0f2; --txt: #000; --card: #fff; }
        body { background: var(--bg); color: var(--txt); font-family: -apple-system, sans-serif; margin: 0; padding: 0; transition: 0.3s; overflow: hidden; }
        
        .screen { display: none; height: 100vh; width: 100%; position: absolute; top: 0; left: 0; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .active { display: block; }

        /* –®–∞–ø–∫–∞ */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; margin-top: 10px; }
        #mini-avatar { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; border: 2px solid var(--accent); transition: 0.2s; }

        /* –°–µ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .app { display: flex; flex-direction: column; align-items: center; cursor: pointer; text-align: center; font-size: 12px; }
        .icon { width: 60px; height: 60px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 30px; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

        /* –°—Ç–∏–ª–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ */
        .section { background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 15px; }
        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .circle-opt { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
        
        button { border: none; padding: 10px 15px; border-radius: 10px; background: var(--accent); color: white; cursor: pointer; font-weight: bold; }
        .back-btn { background: none; color: var(--accent); font-weight: bold; margin-bottom: 15px; display: block; padding: 0; }

        /* –ò–≥—Ä—ã */
        .game-item { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; }
        #game-canvas { background: #000; width: 100%; height: 250px; border-radius: 10px; margin-top: 10px; border: 2px solid var(--accent); }

        /* –ê–≤–∞—Ç–∞—Ä */
        .avatar-preview { width: 100px; height: 100px; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 50px; border: 3px solid var(--accent); transition: 0.3s; }
        .emoji-item { font-size: 30px; background: var(--card); padding: 10px; border-radius: 12px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="scr-main" class="screen active">
        <div class="header">
            <h1 id="h-title">–°–º–∞—Ä—Ç—Ñ–æ–Ω</h1>
            <div id="mini-avatar" style="background: #4cd964;">üë®</div>
        </div>
        <div class="grid">
            <div class="app" onclick="showScreen('scr-weather')"><div class="icon" style="background: #ffcc00;">‚òÄÔ∏è</div><span id="m-weather">–ü–æ–≥–æ–¥–∞</span></div>
            <div class="app" onclick="showScreen('scr-games')"><div class="icon" style="background: #ff5e5e;">üéÆ</div><span id="m-games">–ò–≥—Ä—ã</span></div>
            <div class="app" onclick="showScreen('scr-settings')"><div class="icon" style="background: #8e8e93;">‚öôÔ∏è</div><span id="m-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></div>
            <div class="app" onclick="showScreen('scr-avatar')"><div class="icon" style="background: #4cd964;">üë§</div><span id="m-char">–ü–µ—Ä—Å–æ–Ω–∞–∂</span></div>
        </div>
    </div>

    <div id="scr-weather" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <h2>–ü–æ–≥–æ–¥–∞</h2>
        <div class="section">
            <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –±–æ—Ç –ø—Ä–∏—Å–ª–∞–ª –ø—Ä–æ–≥–Ω–æ–∑ –≤ —á–∞—Ç.</p>
            <button onclick="tg.sendData('/weather')">–£–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É</button>
        </div>
    </div>

    <div id="scr-games" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <div id="game-list">
            <div class="game-item" onclick="startPlay('Snake')"><span>üêç</span> <b>–ó–º–µ–π–∫–∞</b></div>
            <div class="game-item" onclick="startPlay('Tanks')"><span>üöú</span> <b>–¢–∞–Ω—á–∏–∫–∏</b></div>
            <div class="game-item" onclick="startPlay('Mines')"><span>üí£</span> <b>–°–∞–ø—ë—Ä</b></div>
        </div>
        <div id="game-zone" style="display:none;">
            <h3 id="cur-game-name">–ò–≥—Ä–∞</h3>
            <div id="game-canvas"></div>
            <button style="width:100%; margin-top:10px;" onclick="exitGame()">–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã</button>
        </div>
    </div>

    <div id="scr-settings" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="section">
            <h3 id="set-lang">–Ø–∑—ã–∫</h3>
            <div class="btn-row">
                <button onclick="changeLang('ru')">RU</button>
                <button onclick="changeLang('en')">EN</button>
                <button onclick="changeLang('by')">BY</button>
            </div>
        </div>
        <div class="section">
            <h3 id="set-bg">–§–æ–Ω —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="btn-row">
                <div class="circle-opt" style="background: #1a1a1a;" onclick="setTheme('dark')"></div>
                <div class="circle-opt" style="background: #f0f0f2;" onclick="setTheme('light')"></div>
                <div class="circle-opt" style="background: linear-gradient(to bottom, #1e3c72, #2a5298);" onclick="setCustomBg(this.style.background)"></div>
            </div>
        </div>
    </div>

    <div id="scr-avatar" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="avatar-preview" id="big-av" style="background: #4cd964;">üë®</div>
        
        <div class="section">
            <div class="btn-row" style="justify-content: center;">
                <span class="emoji-item" onclick="setEmoji('üë®')">üë®</span>
                <span class="emoji-item" onclick="setEmoji('üë©')">üë©</span>
                <span class="emoji-item" onclick="setEmoji('ü§ñ')">ü§ñ</span>
                <span class="emoji-item" onclick="setEmoji('üê±')">üê±</span>
            </div>
        </div>

        <div class="section">
            <h3 style="margin-top:0">–¶–≤–µ—Ç —Ñ–æ–Ω–∞</h3>
            <div class="btn-row">
                <div class="circle-opt" style="background:#ff5f6d" onclick="setAvBg('#ff5f6d')"></div>
                <div class="circle-opt" style="background:#84fab0" onclick="setAvBg('#84fab0')"></div>
                <div class="circle-opt" style="background:#a1c4fd" onclick="setAvBg('#a1c4fd')"></div>
            </div>
        </div>
        <button style="width:100%" onclick="saveAv()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function setTheme(t) { document.body.className = t; document.body.style.background = ""; }
        function setCustomBg(b) { document.body.style.background = b; }

        function setEmoji(e) { 
            document.getElementById('big-av').innerText = e; 
            document.getElementById('mini-avatar').innerText = e;
        }
        function setAvBg(c) { 
            document.getElementById('big-av').style.background = c; 
            document.getElementById('mini-avatar').style.background = c;
        }

        function changeLang(l) {
            const d = {
                ru: {h:"–°–º–∞—Ä—Ç—Ñ–æ–Ω", w:"–ü–æ–≥–æ–¥–∞", g:"–ò–≥—Ä—ã", s:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏", c:"–ü–µ—Ä—Å–æ–Ω–∞–∂"},
                en: {h:"Phone", w:"Weather", g:"Games", s:"Settings", c:"Character"},
                by: {h:"–°–º–∞—Ä—Ç—Ñ–æ–Ω", w:"–ù–∞–¥–≤–æ—Ä'–µ", g:"–ì—É–ª—å–Ω—ñ", s:"–ù–∞–ª–∞–¥—ã", c:"–ü–µ—Ä—Å–∞–Ω–∞–∂"}
            }[l];
            document.getElementById('h-title').innerText = d.h;
            document.getElementById('m-weather').innerText = d.w;
            document.getElementById('m-games').innerText = d.g;
            document.getElementById('m-settings').innerText = d.s;
            document.getElementById('m-char').innerText = d.c;
        }

        function startPlay(name) {
            document.getElementById('game-list').style.display = 'none';
            document.getElementById('game-zone').style.display = 'block';
            document.getElementById('cur-game-name').innerText = name;
            document.getElementById('game-canvas').innerHTML = `<div style="color:white; padding:20px;">–ó–∞–≥—Ä—É–∑–∫–∞ ${name}...<br>–£—Ä–æ–≤–µ–Ω—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!</div>`;
        }

        function exitGame() {
            document.getElementById('game-list').style.display = 'block';
            document.getElementById('game-zone').style.display = 'none';
        }

        function saveAv() {
            let e = document.getElementById('big-av').innerText;
            tg.sendData("AVATAR:" + e);
        }
    </script>
</body>
</html>
