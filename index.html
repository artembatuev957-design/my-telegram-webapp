<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #1a1a1a; --txt: #fff; --accent: #007aff; --card: #2b2b2b; }
        body.light { --bg: #f0f0f2; --txt: #000; --card: #fff; }
        body { background: var(--bg); color: var(--txt); font-family: -apple-system, sans-serif; margin: 0; padding: 0; transition: 0.3s; overflow: hidden; touch-action: manipulation; }
        
        .screen { display: none; height: 100vh; width: 100%; position: absolute; top: 0; left: 0; padding: 20px; box-sizing: border-box; }
        .active { display: block; }

        /* –®–∞–ø–∫–∞ */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        #mini-avatar { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; border: 2px solid var(--accent); }

        /* –ú–µ–Ω—é */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .app { display: flex; flex-direction: column; align-items: center; cursor: pointer; text-align: center; font-size: 12px; }
        .icon { width: 60px; height: 60px; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 30px; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

        /* –ö–Ω–æ–ø–∫–∏ */
        button { border: none; padding: 10px 15px; border-radius: 10px; background: var(--accent); color: white; cursor: pointer; font-weight: bold; }
        .back-btn { background: none; color: var(--accent); font-weight: bold; margin-bottom: 15px; display: block; padding: 0; }

        /* –ò–ì–†–û–í–ê–Ø –ó–û–ù–ê */
        #game-container { position: relative; width: 100%; max-width: 400px; margin: 0 auto; text-align: center; }
        canvas { background: #000; border: 2px solid var(--accent); display: block; margin: 0 auto; border-radius: 8px; image-rendering: pixelated; }
        
        .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; width: 180px; margin-left: auto; margin-right: auto; }
        .controls button { height: 50px; font-size: 20px; }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ê–≤–∞—Ç–∞—Ä */
        .section { background: var(--card); padding: 15px; border-radius: 15px; margin-bottom: 15px; }
        .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; justify-content: center; }
        .circle-opt { width: 40px; height: 40px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
        .emoji-item { font-size: 30px; background: var(--card); padding: 10px; border-radius: 12px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="scr-main" class="screen active">
        <div class="header">
            <h1>–°–º–∞—Ä—Ç—Ñ–æ–Ω</h1>
            <div id="mini-avatar" style="background: #4cd964;">üë®</div>
        </div>
        <div class="grid">
            <div class="app" onclick="showScreen('scr-weather')"><div class="icon" style="background: #ffcc00;">‚òÄÔ∏è</div><span>–ü–æ–≥–æ–¥–∞</span></div>
            <div class="app" onclick="showScreen('scr-games')"><div class="icon" style="background: #ff5e5e;">üéÆ</div><span>–ò–≥—Ä—ã</span></div>
            <div class="app" onclick="showScreen('scr-settings')"><div class="icon" style="background: #8e8e93;">‚öôÔ∏è</div><span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></div>
            <div class="app" onclick="showScreen('scr-avatar')"><div class="icon" style="background: #4cd964;">üë§</div><span>–ü–µ—Ä—Å–æ–Ω–∞–∂</span></div>
        </div>
    </div>

    <div id="scr-games" class="screen">
        <button class="back-btn" onclick="stopGame(); showScreen('scr-main');">‚Üê –ù–∞–∑–∞–¥</button>
        <div id="game-menu">
            <button style="width:100%; margin-bottom:10px;" onclick="initSnake()">üêç –ó–º–µ–π–∫–∞</button>
            <button style="width:100%; margin-bottom:10px;" onclick="alert('–¢–∞–Ω—á–∏–∫–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ: —Å—Ç–µ–Ω—ã –∏ –∫—É—Å—Ç—ã —Ä–∞—Å—Å—Ç–∞–≤–ª—è—é—Ç—Å—è...')">üöú –¢–∞–Ω—á–∏–∫–∏</button>
            <button style="width:100%; margin-bottom:10px;" onclick="alert('–°–∞–ø–µ—Ä: –º–∏–Ω—ã –∑–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è...')">üí£ –°–∞–ø—ë—Ä</button>
        </div>

        <div id="game-area" style="display:none;">
            <h3 id="game-name">–ò–≥—Ä–∞</h3>
            <canvas id="gameCanvas" width="300" height="300"></canvas>
            <div class="controls" id="snake-ctrl">
                <div></div><button onclick="changeDir('up')">‚ñ≤</button><div></div>
                <button onclick="changeDir('left')">‚óÄ</button><button onclick="changeDir('down')">‚ñº</button><button onclick="changeDir('right')">‚ñ∂</button>
            </div>
        </div>
    </div>

    <div id="scr-settings" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="section">
            <h3>–Ø–∑—ã–∫</h3>
            <div class="btn-row">
                <button onclick="alert('–Ø–∑—ã–∫ RU')">RU</button>
                <button onclick="alert('–Ø–∑—ã–∫ EN')">EN</button>
            </div>
        </div>
        <div class="section">
            <h3>–§–æ–Ω —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="btn-row">
                <div class="circle-opt" style="background:#1a1a1a" onclick="setBg('#1a1a1a')"></div>
                <div class="circle-opt" style="background:#f0f0f2" onclick="setBg('#f0f0f2')"></div>
                <div class="circle-opt" style="background:linear-gradient(#1e3c72, #2a5298)" onclick="setBg('linear-gradient(#1e3c72, #2a5298)')"></div>
            </div>
        </div>
    </div>

    <div id="scr-avatar" class="screen">
        <button class="back-btn" onclick="showScreen('scr-main')">‚Üê –ù–∞–∑–∞–¥</button>
        <div id="big-av" style="width:80px; height:80px; border-radius:50%; background:#4cd964; margin:0 auto 20px; display:flex; align-items:center; justify-content:center; font-size:40px; border:3px solid var(--accent);">üë®</div>
        <div class="section">
            <div class="
